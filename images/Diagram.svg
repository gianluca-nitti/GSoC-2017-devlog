<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1008px" height="541px" version="1.1" content="&lt;mxfile userAgent=&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36&quot; version=&quot;6.7.11&quot; editor=&quot;www.draw.io&quot; type=&quot;device&quot;&gt;&lt;diagram name=&quot;Page-1&quot; id=&quot;271e5c7a-1c2c-de32-b02e-3d4d69b79640&quot;&gt;7VrfU9s4EP5rMnP3QMexEwOPEKBcZ+5gcDrtPSq2Yqu1JVeSE9K//lay/NshIZi03MADkdarlfaTdr+1kpEzSx4/cpRGf7MAxyPbCh5HztXItsdnjgMfSrLJJa7j5oKQk8AoVQKP/MRGaBlpRgIsGoqSsViStCn0GaXYlw0Z4pytm2pLFjdnTVGIOwLPR3Eh/TCt5F9IICMjH7vn1YNbTMLITH5mGw8XyP8ecpZRM+PIdpb6L3+coMKWcVVEKGDrmsi5HjkzzpjMW8njDMcK3QK4YpzcFKsdOZeRTGLojKGpH99sGTzeZzA4xzGV9em22TMwrVCcFfbaE+AAoDVdyihuTohpcKE2DLqLmPnfc9ENiZsrUkZaG1YtsXCKZdw3Wub8ScRDbLQmJbhwbDFLsOQbUOE4RpKsmtaROT9hqVdhAA0DQz8kTg8kbgyLuFxAI1SNL3jhga+wMjjCMVGOGBUwXmqVw3hbEpBVIToBEx5Wh+2iZqOm0DNmu+HdQ0+foWu7KEmhQRcizfs/MnWsLxMsBMTPfJPiSqg9sKr+w7V39/lhdl3TsGcDTI58SRjdPu+aE4kPnlSLRIro7oUESKLOMhr4tuwc6nnNOY5NlGx134+QHApy6znOHmJ8+3zmiG338xailmn3LBkRoQJY/UMqJDUEVtfESxZ7enX48OeM3a7bysuao7BKWpY69RGcei9FOoGugdWbaRrFJKTQjvFSGVthLgnQ5YURS5aWU6hn+PHpZN1Nw2bAqWE3UzfYrumvKw4uGTCq0a89sV6euU9/UzKbdMnMPRKZTfYgM3GLaBBj/hSHDcM+iuzmEea4jFaqWtRnCaFhI2T3N/iAUaCTAG7kB5ZJ7VIZ+9Yn7+4f+GCLb1Byijx1gOeqviT6A4ZoQ0iW9jKhjMC+/MiwkFhPxNR5zkkm7+SqJuvUMvT+Pngmk0FIxqVBPcdDaQ7AkRHT61SofRKMegCX5kI1VqTY3yxzHBs+1BdfrS7fgJlWrJBIkRAN509ElqZQ4qiHmgMOqFMGqz/+Z5QxYKH3FrjBKV6xniIH57XIYTz+TdnB7bLD2OoHcnB6cHfTQyPPHIkgnkp+EVIxu8CYmnypU9OS8R4OaNfC9fS3JnDmTPDDqUZE2UsJ1g/Zskh3h2Rx2HCBy+XkZhpMwThXtx4FF0HjDz29yUo+UsOVJaKerRmPA+2zWa/kZEVQXB/vM6pcyLM/o/HGqArQpeGftRT/DH9mHTbqsFDboV3s9xby1PTcaeSpyfSoecraHZOKtR+6SB8nKHcGozpqsJV+VItLfa6rwzHTRhAVjXBFQVXIlUzcU2KJDVQziZo4I7E8IXkRWWphGhK6B4e/hbN4NnF/5Vk8f3XOBBz45qsBXXf+VZ0P04P5dDztEqr9UkI1Q+8ZUXd9ZUXTet11z1qg52swo1q4l8vYbyv6bmpbaeF2Pr8fDXcjWYtb/QLxnNL//s6b69i+KYIeDN0YPn71W07D7SnaxAwd7Wr1/frsoHeht5CGW3E+Peq11rh7r6VYtYUbOCeb4EDkkZ9ooRUUlqlKQ3od08vR9ErBl0km8i/v9kZTwGZASTlXnauTyTD4jt1pE2C7C3Avyw0Ab893ajs47ZHIr7V2RVjbyOx0ug8VHkZ3BQS/4nbR3qNWvZUyvbj/y8N8FeMnWWm4alWlOsNABXeZOrKXkKw1ymnOx4COqWAFM+mwKHpZijnKv3qykkyb1G9kIIYqN8Htd6L368Atm/p+Hfh+HTjqXgf2kupQrzYq7sufZOTld/XLF+f6Pw==&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g transform="translate(0.5,0.5)"><path d="M 220 120 L 247.88 120" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 254.88 120 L 247.88 123.5 L 247.88 116.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="0" y="0" width="220" height="240" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(2.5,7.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="216" height="189" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 216px; white-space: normal; word-wrap: normal;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><b>WebSocket client</b><br /><div>- Send:</div><div><br /></div><div>{</div><div> "messageType": "RESOURCE",</div><div> "action": "write",</div><div><span> "data": {</span></div><div>  "resource": "chat",</div><div>  "data": {</div><div>    "message": "Hello, this is a chat message"</div><div>  }</div><div> }</div><div>}</div></div></div></foreignObject><text x="108" y="101" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 486 201.84 L 516.39 223.46" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 522.09 227.52 L 514.36 226.31 L 518.42 220.61 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="256" y="0" width="230" height="240" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(258.5,7.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="226" height="203" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 226px; white-space: normal; word-wrap: normal;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><b>WsHandler</b><div><br /></div><div>- There is an incoming message</div><div>- Read the "outer" JSON objects, and find out that the user requested to write to the chat resource</div><div>- So, call the writeResource method on JsonSession, specyfing that the requested resource is Chat, and pass the user-supplied data:</div><div><div>{</div><div>    "message": "Hello, this is a chat message"</div><div>  }</div></div><div><br /></div></div></div></foreignObject><text x="113" y="108" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 753 310 L 767.88 310" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 774.88 310 L 767.88 313.5 L 767.88 306.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="523" y="190" width="230" height="240" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(525.5,197.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="226" height="134" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 226px; white-space: normal; word-wrap: normal;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><b>JsonSession</b><div><br /></div><div>- The writeResource method has been called for the "chat" resource with a certain piece of data</div><div>- So, parse the data to the correct object (in this case, it world be a trivial object containing only a string), and</div><div>- Call the write method on the correct resource</div></div></div></foreignObject><text x="113" y="73" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="776" y="190" width="230" height="240" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(778.5,197.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="226" height="80" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 226px; white-space: normal; word-wrap: normal;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><b>ChatResource</b><div><br /></div><div>- The write method has been called, which for this resource, means "add the message to the chat system built-in in the engine"</div></div></div></foreignObject><text x="113" y="46" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 220 420 L 247.88 420" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 254.88 420 L 247.88 423.5 L 247.88 416.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="0" y="300" width="220" height="240" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(2.5,307.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="216" height="134" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 216px; white-space: normal; word-wrap: normal;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><b>HTTP client</b><br /><div>- Send this request:</div><div>POST /resources/chat</div><div><br /></div><div>with payload:</div><div><br /></div><div>  "data": {</div><div>    "message": "Hello, this is a chat message"</div><div>  }</div></div></div></foreignObject><text x="108" y="73" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(96.5,262.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="10" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">or</div></div></foreignObject><text x="5" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">or</text></switch></g><path d="M 486 420 L 518.17 376.53" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 522.33 370.9 L 520.98 378.61 L 515.36 374.44 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="256" y="300" width="230" height="240" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(258.5,307.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="226" height="189" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 226px; white-space: normal; word-wrap: normal;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><b>HttpAPIServlet</b><div><br /></div><div>- A POST request to /resources/chat was received, so a write operation must be performed on the chat resource</div><div>- So, call the writeResource method on JsonSession, specyfing that the requested resource is Chat, and pass the user-supplied data:</div><div><div>{</div><div>    "message": "Hello, this is a chat message"</div><div>  }</div></div><div><br /></div></div></div></foreignObject><text x="113" y="101" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g></g></svg>