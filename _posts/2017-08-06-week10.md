---
date: 2017-08-06
category: week10
---

#### Completed module installation from web interface, added access to two configuration entries, and did some improvements on the identity storage server
As the title says, this week's update spans on multiple topics, like last week's one.\\
After doing some final improvements to the quite big [FacadeServer's pull request #4](https://github.com/MovingBlocks/FacadeServer/pull/4){:.gh-pr}, which now has been merged, I completed the support in the server and in the client to allow server administrators to install modules (in the previous posts I explained what I changed in the Terasology Engine repository to make this feature possible, code which is in [Engine Pull Request #3028](https://github.com/MovingBlocks/Terasology/pull/3028){:.gh-pr}). As usual, the client code is in [its repository](https://github.com/gianluca-nitti/FacadeServer-frontend) and deployed to [GitHub pages](https://gianluca-nitti.github.io/FacadeServer-frontend/), and the server code is in a [pull request (#5)](https://github.com/MovingBlocks/FacadeServer/pull/5){:.gh-pr}. Here is a screenshot of the user interface:

![Screenshot]({{ site.baseurl }}/images/client-modules-1.PNG) \\
\\
Before taking this screenshot, a module installation was started - so that you can see the progress reporting - then the "install new modules" dialog has been reopened. Choosing some modules and clicking *Start installation* now would queue the new modules for download after the current ones; at the the current state of the application, however, this wouldn't be reported in any way, i.e. it won't increase the number 14 in the "Downloaded modules: 7 of 14" message. After finishing the previous install transaction (i.e. reaching "Downloaded 14 of 14"), it would change to the new "Downloaded modules: 0 of 3" assuming, for example, that you chose one module with two dependencies.\\
\\
I then moved to the [identity storage server](https://github.com/gianluca-nitti/terasology-key-server) code. As I said in the previous post, the service needs to support HTTPS to be used as an authentication method from the FacadeServer client instance hosted at GitHub pages, since it's served over HTTPS as well and trying to make a plain HTTP request from a web page served over HTTPS results in a [Mixed Content](https://developers.google.com/web/fundamentals/security/prevent-mixed-content/what-is-mixed-content) error. So I added support for loading HTTPS certificates in the storage server application, and in the meantime improved the installation method which now is based on Docker and docker-compose. More information is available in the [README file](https://github.com/gianluca-nitti/terasology-key-server/blob/master/README.md#how-to-install). At the moment no HTTPS-secured instance is deployed, but I'll see if I can avoid the Mixed Content error by using a self-signed certificate on the instance hosted on my DigitalOcean droplet.\\
\\
At the end of the week I added additional classes to FacadeServer to provide access to two entries of the engine configuration - the only ones I could find which are relevant to an headless server, at the moment: the network port on which the server listens for connections, and the Message Of The Day which is shown when a client joins the server. This code is in another small [pull request (#6)](https://github.com/MovingBlocks/FacadeServer/pull/6){:.gh-pr}. The read access to this information is public (i.e. accessible to everyone which connects to the server via HTTP or WebSocket), while the write access is restricted to authenticated server administrators. I also upgraded the client with proper UI components to provide access to this feature. Here is a screenshot of the settings page:

![Screenshot]({{ site.baseurl }}/images/client-config-1.PNG) \\
\\
Clicking the "Save settings" button will apply the changes if you are authenticated and your client ID is in the server admin list (otherwise, you would get an error message); the new Message Of The Day should be immediately visible to new clients which join the server, while if you change the port number and a game is running you need to stop and restart it (which will obviously disconnect all the connected clients; users would need to update the port number to the new value in their client to be able to reconnect).
